<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <title>Vibestr ‚Ä¢ Nostr Viewer</title>
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icons/icon.svg" type="image/svg+xml" />
  <meta name="description" content="A lightweight PWA to follow Nostr npubs and view their latest posts." />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <noscript>This app requires JavaScript to function fully.</noscript>

  <header class="topbar">
    <button id="burgerBtn" class="icon-btn" aria-label="Open menu" title="Menu">‚ò∞</button>
    <div id="viewTitle" class="brand">Inbox</div>
    <div class="spacer"></div>
  </header>

  <aside id="drawer" class="drawer">
    <div class="drawer-header">
      <h2 class="drawer-title">Vibestr</h2>
      <button id="closeDrawerBtn" class="icon-btn" aria-label="Close menu">‚úï</button>
    </div>
    <nav class="drawer-nav">
      <button class="nav-item" data-view="inbox">Inbox</button>
      <button class="nav-item" data-view="favorites">Favorites</button>
      <button class="nav-item" data-view="archive">Archive</button>
      <button class="nav-item" data-view="following">Following</button>
      <hr />
      <button class="nav-item" data-view="settings">Settings</button>
    </nav>
    <div class="drawer-build"><small id="buildTag" class="muted"></small></div>
  </aside>
  <div id="scrim" class="scrim" hidden></div>

  <main id="content" class="content">
    <section id="emptyState" class="empty">
      <p>No posts yet.</p>
      <p>Add npubs to follow, then tap ‚ÄúFetch posts‚Äù.</p>
      <button id="emptyFetchBtn" class="chip">Fetch posts</button>
    </section>
    <section id="archiveToolbar" class="archive-bar" hidden>
      <button id="archiveFavToggle" class="toggle-btn" aria-pressed="false" type="button">Only favorites</button>
    </section>
    <dialog id="storageDialog" class="dialog">
     <form method="dialog" class="dialog-body">
       <h3>Storage Management</h3>
       <div class="kv">
         <div>localStorage used</div>
         <div id="lsUsed">0 B</div>
       </div>
       <div class="kv">
         <div>Posts stored</div>
         <div id="postCount">0</div>
       </div>
       <p class="muted">Favorites are never purged. Vibestr keeps your last 100 non-favorite posts automatically. Use the buttons below to wipe storage or your follow list.</p>
        <!-- Backup & Restore follows -->
        <p class="muted">Backup & Restore your follow list</p>
        <input id="importFollowsFile" type="file" accept="application/json" hidden />
        <input id="restoreFollowsFile" type="file" accept="application/json" hidden />
       <menu class="dialog-actions">
          <button id="exportFollowsBtn" type="button">Export Follows</button>
          <button id="importFollowsBtn" type="button">Import Follows (Merge)</button>
          <button id="restoreFollowsConfirmBtn" type="button" class="danger">Restore Follows (Replace)</button>
          <button id="nukePostsConfirmBtn" type="button" class="danger">Nuke Posts</button>
          <button id="nukeFollowsConfirmBtn" type="button" class="danger">Nuke Follow List</button>
          <button value="cancel">Close</button>
       </menu>
     </form>
   </dialog>
    <section id="feed" class="feed" aria-live="polite"></section>
  </main>
  

  

  <template id="postTemplate">
    <article class="post" tabindex="0">
      <header class="post-h">
        <div class="avatar" aria-hidden="true">üë§</div>
        <div class="meta">
          <div class="author" data-field="author">npub‚Ä¶</div>
          <div class="time" data-field="time">just now</div>
        </div>
        <div class="actions">
          <button class="icon-btn fav" title="Favorite" aria-label="Favorite">‚òÜ</button>
        </div>
      </header>
      <div class="post-content" data-field="content"></div>
    </article>
  </template>

  <script type="module" src="./app.js"></script>
</body>
</html>
